{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://lokstra.dev/schema/lokstra-group.json",
  "title": "Lokstra Group Configuration Schema",
  "description": "JSON Schema for Lokstra group configuration files loaded via load_from",
  "type": "object",
  "properties": {
    "routes": {
      "type": "array",
      "description": "Routes to be included in the parent group",
      "items": {
        "$ref": "internal-router.json#/definitions/RouteConfig"
      }
    },
    "groups": {
      "type": "array", 
      "description": "Nested groups to be included in the parent group",
      "items": {
        "$ref": "internal-router.json#/definitions/GroupConfig"
      }
    },
    "mount_static": {
      "type": "array",
      "description": "Static file mount points to be included",
      "items": {
        "$ref": "internal-router.json#/definitions/MountStaticConfig"
      }
    },
    "mount_htmx": {
      "type": "array",
      "description": "HTMX mount points to be included",
      "items": {
        "$ref": "internal-router.json#/definitions/MountHtmxConfig"
      }
    },
    "mount_reverse_proxy": {
      "type": "array",
      "description": "Reverse proxy mount points to be included",
      "items": {
        "$ref": "internal-router.json#/definitions/MountReverseProxyConfig"
      }
    },
    "mount_rpc_service": {
      "type": "array",
      "description": "RPC service mount points to be included",
      "items": {
        "$ref": "internal-router.json#/definitions/MountRpcServiceConfig"
      }
    }
  },
  "additionalProperties": false,
  "not": {
    "anyOf": [
      {
        "required": ["prefix"],
        "errorMessage": "prefix is not allowed at root level in load_from files - define groups inside instead"
      },
      {
        "required": ["override_middleware"],
        "errorMessage": "override_middleware is not allowed at root level in load_from files"
      },
      {
        "required": ["middleware"],
        "errorMessage": "middleware is not allowed at root level in load_from files - define groups inside instead"
      }
    ]
  },
  "examples": [
    {
      "routes": [
        {
          "method": "GET",
          "path": "/external",
          "handler": "external.Handler"
        },
        {
          "method": "POST", 
          "path": "/create",
          "handler": "external.CreateHandler"
        }
      ],
      "mount_static": [
        {
          "prefix": "/assets",
          "folder": "./static"
        }
      ],
      "groups": [
        {
          "prefix": "/nested",
          "routes": [
            {
              "method": "GET",
              "path": "/item",
              "handler": "nested.Handler"
            }
          ]
        }
      ]
    }
  ]
}
